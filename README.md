# PizzaMeow

# О проекте
Наша цель состояла в двух ключевых задачах. Во-первых, мы разработали удобное и функциональное CLI-приложение для заказа пиццы. Во-вторых, мы создали сервер, который обеспечивает основную бизнес-логику.

После настройки репозитория, таск трекеров и настройка miro и notion мы приступили к разработке.

**Нашими основными задачами выступили:**
1. Реализация работы с учётной записью
2. Реализация работы с корзиной
3. Реализация работы с заказами

Работа шла параллельно над сервером и клиентом. При этом каждый пункт выполнялся примерно в такой последовательности:

1. Одновременно:
    - Пишется документация API и функции, которые обрабатывают запросы
    - Пишутся парсеры и сами команды
3. Если для существенного упрощения кода клиента требуется добавить новый функционал серверу, он дописывается
4. Если изменился API, то вносятся правки в клиенте

Каждая задача разбивалась на множество составных и добавлялась в наш [таск-трекер](https://app.todoist.com/auth/join?invite_code=ks4AAgAc2SA5M2Y0YjhmYjI3YjYzNDdmZTJiYjE0MmRiYWQ5Y2UzNA)  (перейдите во вкладку "Проекты, в которых я не участвую" и нажмите на единственный проект "IT-проекты")

Также некоторые задачи требовали некоторой подготовительной работы, в том числе изучение необходимых технологий. Вы можете посмотреть наш [notion](https://melodic-cormorant-2d7.notion.site/738c803f5ca64cc6b341706a4388f3e1?pvs=25)

## Установка
1. Склонируйте проект.
2. Зайдите в папку проекта.
3. Пропишите `pip3 install client/`
4. Теперь вы можете запускать приложение, используя команду pizza

## Запуск сервера
1. Для удобства создайте виртуальное окружение (если у вас его нет) `python3 -m venv venv`
2. Активируйте виртуальное окружение 
- `./venv/bin/activate` (или `source venv/bin/activate`) - если вы на **Unix**
- ???????? - если вы на **Windows**
3. Установите зависимости `pip install -r requirements.txt`
4. Находясь в папке PizzaMeow, запустите сервер:
- `server/runserver.sh` - если вы на **Unix**
- `server/runserver.bat` - если вы на **Windows**

5. Откройте в браузере ваш локальный сервер, документация будет находиться в относительном пути `/api/ui`

**Замечание**

При регистрации пользователю на почту приходит письмо. Эта функция не будет работать, если не указать `smtp_credentials.json`.
Для этого зайдите в папку `server/app/utils/`, создайте в ней файл `smtp_credentials.json` и напишите в нём следующий словарь:
```json
{
    "username": "email@some.thing",
    "password": "password"
}
```
где вместо `username` следует указать почту, с которой будут приходить письма и вместо `password` нужно указать пароль от этой почты.

### Работа с закрытыми ресурсами сервера
Под закрытми ресурсами сервера понимаются те таблицы и действия над ними, которые недоступны через API.

Эта проблема появляется ввиду того, что мы выбрали упрощённый JWT, а не Auth2. Так как JWT не предоставляет ограниченного доступа к ресурсам, нельзя написать запросы, которые имеют разный вид доступа. \
Более того, эта проблема влечёт за собой другую: чтобы добавить, например, новую пиццу в БД, нужно выключить сервер (это связанно с тем, как uvicorn запускает сервер).

Итак, для работы с закрытыми ресурсами сервера написано небольшое cli-приложение, которое позволяет искать, создавать, изменять и удалять записи в БД. \
Запускается это приложение с помощью команды `python3 server/cli_admin.py`